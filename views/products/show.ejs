<% layout('layouts/product-show-layout') -%>

</head>
<body>
  <div class="container mt-5">
    <h1 class="text-center mb-4"><%= product.title %></h1>
    <div class="row">
      <!-- Main Carousel -->
      <div class="col-md-6">
        <% if (product.images && product.images.length > 0) { %>
          <div id="productCarousel" class="carousel slide mb-2" data-bs-ride="carousel">
            <div class="carousel-inner">
              <% product.images.forEach((image, index) => { %>
                <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
                  <img src="<%= image.url %>" alt="<%= product.title %>">
                </div>
              <% }) %>
            </div>
            <% if (product.images.length > 1) { %>
              <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
                <span class="visually-hidden">Previous</span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
                <span class="visually-hidden">Next</span>
              </button>
            <% } %>
          </div>

          <!-- Thumbnails -->
          <div class="d-flex">
            <% product.images.forEach((image, index) => { %>
              <img src="<%= image.url %>" class="thumb-img <%= index === 0 ? 'thumb-active' : '' %>" data-index="<%= index %>">
            <% }) %>
          </div>
        <% } else { %>
          <img src="/images/default-product.jpg" alt="No image available" class="img-fluid rounded mb-2">
        <% } %>
      </div>

      <!-- Product Info -->
      <div class="col-md-6">
        <h3 class="text-success">$<%= product.price.toFixed(2) %></h3>
        <p><strong>Description:</strong> <%= product.description %></p>
        <p><strong>Location:</strong> <%= product.location %></p>
    <!-- Map -->
    <div id="map"></div>
        <div class="d-flex gap-2 mt-4">
          <a href="/products/<%= product._id %>/edit" class="btn btn-primary">Edit Product</a>
          <form action="/products/<%= product._id %>?_method=DELETE" method="POST" onsubmit="return confirm('Are you sure you want to delete this product?');">
            <button type="submit" class="btn btn-danger">Delete Product</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <script>
    // Mapbox
    var product = <%- JSON.stringify(product) %>;
  </script>
 <script src="/javascripts/product-show.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
